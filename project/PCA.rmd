---
title: "Factor models with Principal Component methods: Strengths and weaknesses"
subtitle: "Project for the course Computational Statistics, University of Bonn 2022"
author: "Krasimira Kirilova"
abstract: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed molestie ante risus, in scelerisque arcu iaculis at. Ut nec felis enim. Cras et risus a tellus semper condimentum blandit at tortor. Proin sodales metus ac imperdiet vulputate. Donec non volutpat felis, eu consequat est. Nulla mi tortor, consequat nec pulvinar et, mattis et nisi. Nunc mollis fermentum erat, id volutpat nisi euismod quis.

Duis varius velit eget mattis ullamcorper. Morbi blandit metus ex, quis maximus ipsum elementum non. Mauris pharetra arcu vel pellentesque pulvinar. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Mauris laoreet auctor arcu et faucibus. In lacinia maximus enim, in iaculis eros euismod id. Ut ac auctor augue. In hac habitasse platea dictumst. Praesent et nisi nulla. Aliquam ultrices interdum molestie. Nam viverra nisi quis aliquam fringilla. Fusce tincidunt eros quis elementum tristique."
date: "August 23, 2022"
output: 
  pdf_document:
    toc: true
    number_sections: true
---

# Introduction
```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r}
library("pls") # PCA and PLS regression
library("readxl") # read Excel files
library("MASS")
library("esquisse") # addin for data visualization
library("xts") #time series conversion
```
# Simulation
```{r, results='hide', echo=TRUE, message=FALSE}
source("./functions/data_utils.R")
# Load Data set
load(file = "../data/data/WORKING_DATA.rda")

# CONSTANTS ----
data_row_len <- nrow(hendry_data_raw)

# Variables to forecast:
# CPI inflation
# (aggregate) industrial production, 
# (aggregate) unemployment rate
# (effective) federal funds rate
predictor_variables <- c("CPIAUCSL", "IPS10", "LHUR", "FYFF")

# END CONSTANTS ----
# I need to import this data!
train <- getmacrodata(WORKING_DATA, enddate = as.Date("2006/12/01"))

# Try do to PCA on the whole dataset
set.seed(2)
prediction_var <- train[, predictor_variables]
train <- remove_columns(train, predictor_variables)
result <- pcr(prediction_var ~ ., data = train, scale = TRUE, validaiton = CV)
summary(result)
validationplot(result, val.type = "MSEP")

```